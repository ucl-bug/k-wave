<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Plane Wave Absorption Example (k-Wave)</title>
	<link rel="stylesheet" href="kwavehelpstyle.css" type="text/css">
	<meta name="description" content="Plane Wave Absorption Example.">
</head>

<body>

<a name="top_of_page"></a>
<div class="content">

<h1>Plane Wave Absorption Example</h1>

<p>This example describes the characteristics of the Kelvin-Voigt absorption model used in the k-Wave simulation functions <code><a href="pstdElastic2D.html">pstdElastic2D</a></code>, <code><a href="pstdElastic3D.html">pstdElastic3D</a></code>. It builds on the <a href="example_ewp_layered_medium.html">Explosive Source In A Layered Medium</a> and <a href="example_na_modelling_absorption.html">Modelling Power Law Absorption</a> examples.</p>


To open the file in MATLAB, enter the following command in the MATLAB Command Window.
<pre class="codeinput">
edit([getkWavePath('examples') 'example_ewp_plane_wave_absorption.m']);
</pre>
To run the file, enter the following command in the MATLAB Command Window.
<pre class="codeinput">
run([getkWavePath('examples') 'example_ewp_plane_wave_absorption']);
</pre>
</p>

<h2>Contents</h2>
<div>
	<ul>
		<li><a href="#heading2">Kelvin-Voigt absorption model</a></li>
		<li><a href="#heading3">Absorption of plane waves</a></li>
	</ul>
</div>

<a name="heading2"></a>
<h2>Kelvin-Voigt absorption model</h2>

<p>The functions in k-Wave for simulating wave propagation in solid media (<code><a href="pstdElastic2D.html">pstdElastic2D</a></code>, <code><a href="pstdElastic3D.html">pstdElastic3D</a></code>) are based on the classical Kelvin-Voigt model of viscoelasticity. For low frequencies and small absorption coefficients, this gives acoustic absorption that is proportional to frequency squared. The compressional and shear absorption coefficients are defined based on this low frequency limit, and are specified in units of dB/(MHz^2 cm).</p>

<pre class="codeinput">
<span class="comment">% set the absorption properties</span>
medium.alpha_coeff_compression = 1;     <span class="comment">% [dB/(MHz^2 cm)]</span>
medium.alpha_coeff_shear       = 1;     <span class="comment">% [dB/(MHz^2 cm)]</span>
</pre>

<p>These absorption coefficients are related to the compressional and shear viscosities of the medium by:</p>

<pre class="codeinput">
alpha_coeff_compression_np = (chi + 2*eta) / (2 * rho0 * cp^3);
alpha_coeff_shear_np       = (eta) / (2 * rho0 * cs^3);
</pre>

<p>where <code>chi</code> and <code>eta</code> are the compressional and shear viscosity coefficients, respectively, <code>cp</code> and <code>cs</code> are the compressional and shear sound speeds, respectively, <code>rho0</code> is the mass density, and the absorption coefficients are given in units of Nepers/((rad/s)^2 m) (see <code><a href="db2neper.html">db2neper</a></code> and <code><a href="neper2db.html">neper2db</a></code>). Within the simulation functions, the absorption coefficients are used to calculate the viscosities, and it is these variables that are used in the model. The absorption coefficients can be defined either as a single value, or as a matrix the same size as the computational grid.</p>

<a name="heading3"></a>
<h2>Absorption of plane waves</h2>

<p>In this example, the absorption of compressional and shear waves is demonstrated by generating plane waves using a velocity source. A compressional plane wave can be generated by assigning a velocity source parallel with the direction of wave propagation, while a shear plane wave can be generated by assigning a velocity source in the perpendicular direction. In both case, the PML must be switch off in the direction perpendicular to the direction of the wave by setting the PML absorption to zero (see <a href="example_na_controlling_the_pml.html">Controlling The Absorbing Boundary Layer</a>).</p>

<p>The absorption encapsulated by the model is extracted using the velocity traces recorded at two sensor points separated by some distance (see <a href="example_na_modelling_absorption.html">Modelling Power Law Absorption</a>). The time traces and absorption behaviour are shown in the figure below. The modelled absorption is shown with the open circles, while the corresponding analytical frequency power law is shown with the solid line. There is a very close agreement up to the Nyquist limit of two points per wavelength, illustrating that the desired absorption behaviour is captured by the model.</p>

<img vspace="5" hspace="5" src="images/example_ewp_plane_wave_absorption_01.png" style="width:560px;height:630px;" alt="">

</div></body></html>